{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/settings.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '52683370-9ae3cf283454fd0e20897a7f1';\nconst BASE_URL = 'https://pixabay.com/api/';\nexport const PER_PAGE = 9;\n\nconst API_PARAMS = {\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: PER_PAGE,\n};\n\nexport function getImagesByQuery(query, page) {\n  if (!query || typeof query !== 'string') {\n    return Promise.reject(new Error('Invalid query parameter'));\n  }\n\n  const params = {\n    key: API_KEY,\n    q: query,\n    page,\n    ...API_PARAMS,\n  };\n\n  return axios.get(BASE_URL, { params });\n}\n","import SimpleLightbox from 'simplelightbox';\n\nconst loaderEl = document.querySelector('.loader');\nconst galleryListEl = document.querySelector('.gallery');\nexport const loadBtnEl = document.querySelector('.load-btn');\n\nconst galleryLightbox = new SimpleLightbox('.gallery-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  const photoCardsMarkup = images\n    .map(image => createGalleryCard(image))\n    .join('');\n\n  galleryListEl.insertAdjacentHTML('beforeend', photoCardsMarkup);\n  galleryLightbox.refresh();\n}\n\nfunction createGalleryCard(image) {\n  return `\n    <li class=\"gallery-card\">\n      <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n        <img\n          src=\"${image.webformatURL}\"\n          alt=\"${image.tags}\"\n        />\n      </a>\n      <div class=\"card-description\">\n        <div class=\"description-item\">\n          <h2 class=\"description-title\">Likes</h2>\n          <p class=\"description-value\">${image.likes}</p>\n        </div>\n        <div class=\"description-item\">\n          <h2 class=\"description-title\">Views</h2>\n          <p class=\"description-value\">${image.views}</p>\n        </div>\n        <div class=\"description-item\">\n          <h2 class=\"description-title\">Comments</h2>\n          <p class=\"description-value\">${image.comments}</p>\n        </div>\n        <div class=\"description-item\">\n          <h2 class=\"description-title\">Downloads</h2>\n          <p class=\"description-value\">${image.downloads}</p>\n        </div>\n      </div>\n    </li>\n  `;\n}\n\nexport function clearGallery() {\n  galleryListEl.innerHTML = '';\n}\n\nexport function showLoader() {\n  loaderEl.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  loaderEl.classList.add('hidden');\n}\n\nexport function showLoadBtn() {\n  loadBtnEl.classList.remove('hidden');\n}\n\nexport function hideLoadBtn() {\n  loadBtnEl.classList.add('hidden');\n}\n\nexport function bindLoadMoreHandler(callback) {\n  loadBtnEl.addEventListener('click', callback);\n}\n\nexport function unbindLoadMoreHandler(callback) {\n  loadBtnEl.removeEventListener('click', callback);\n}\n\nexport function scrollGallery() {\n  const cardEl = document.querySelector('.gallery-card');\n  const cardHeight = cardEl.getBoundingClientRect().height;\n  const scrollHeight = cardHeight * 2;\n\n  scrollBy({\n    top: scrollHeight,\n    behavior: 'smooth',\n  });\n}\n","import iziToast from 'izitoast';\n\niziToast.settings({\n  timeout: 4000,\n  theme: 'dark',\n  position: 'topRight',\n  resetOnHover: true,\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n});\n\nexport const toastMessage = message => iziToast.show({ message: [message] });\n","import { getImagesByQuery, PER_PAGE } from './js/pixabay-api';\nimport * as render from './js/render-functions';\nimport { toastMessage } from './js/settings';\n\nconst formEl = document.querySelector('.form');\nconst inputEl = formEl.elements['search-text'];\n\nlet currentPage = 1;\nlet pagesAmount = 0;\nlet query = '';\n\nformEl.addEventListener('submit', onSearch);\n\nfunction onSearch(e) {\n  e.preventDefault();\n  handleImageSearch();\n  formEl.reset();\n}\n\nasync function handleImageSearch() {\n  try {\n    query = inputEl.value.trim();\n\n    if (!query) {\n      toastMessage('&#128269; enter the query to search');\n      return;\n    }\n\n    currentPage = 1;\n    render.hideLoadBtn();\n    render.clearGallery();\n    render.showLoader();\n\n    const { data } = await getImagesByQuery(query, currentPage);\n    const images = data.hits;\n\n    render.hideLoader();\n\n    if (images.length === 0) {\n      toastMessage(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n\n    render.createGallery(images);\n\n    pagesAmount = Math.ceil(data.totalHits / PER_PAGE);\n    if (pagesAmount > 1) {\n      render.showLoadBtn();\n      render.bindLoadMoreHandler(onLoadMore);\n    } else {\n      endOfListMsg();\n    }\n  } catch (error) {\n    handleError(error);\n  }\n}\n\nasync function onLoadMore() {\n  try {\n    currentPage++;\n    render.hideLoadBtn();\n    render.unbindLoadMoreHandler(onLoadMore);\n    render.showLoader();\n\n    const { data } = await getImagesByQuery(query, currentPage);\n    const images = data.hits;\n\n    render.hideLoader();\n\n    if (images.length === 0) {\n      toastMessage(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n\n    render.createGallery(images);\n    render.scrollGallery();\n\n    if (pagesAmount > currentPage) {\n      render.showLoadBtn();\n      render.bindLoadMoreHandler(onLoadMore);\n    } else {\n      endOfListMsg();\n    }\n  } catch (error) {\n    handleError(error);\n  }\n}\n\nfunction handleError(error) {\n  render.hideLoader();\n  toastMessage('Failed to fetch images. Please try again later.');\n  console.log(error);\n}\n\nfunction endOfListMsg() {\n  toastMessage(\"We're sorry, but you've reached the end of search results.\");\n}\n"],"names":["API_KEY","BASE_URL","PER_PAGE","API_PARAMS","getImagesByQuery","query","page","params","axios","loaderEl","galleryListEl","loadBtnEl","galleryLightbox","SimpleLightbox","createGallery","images","photoCardsMarkup","image","createGalleryCard","clearGallery","showLoader","hideLoader","showLoadBtn","hideLoadBtn","bindLoadMoreHandler","callback","unbindLoadMoreHandler","scrollGallery","scrollHeight","iziToast","toastMessage","message","formEl","inputEl","currentPage","pagesAmount","onSearch","handleImageSearch","render.hideLoadBtn","render.clearGallery","render.showLoader","data","render.hideLoader","render.createGallery","render.showLoadBtn","render.bindLoadMoreHandler","onLoadMore","endOfListMsg","error","handleError","render.unbindLoadMoreHandler","render.scrollGallery"],"mappings":"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"}